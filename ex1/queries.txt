// Quantos listas de compras têm o produto Broa
db.listas.countDocuments({ "produtos.designacao": "Broa" })

// Quais as listas de compras em que se compra Nabos?
db.listas.find({ "produtos.designacao": "Nabos" }, { designacao: 1, _id: 0 })

// Qual a lista de categorias (ordenada alfabeticamente e sem repetições)?
db.listas.aggregate([
  { $unwind: "$produtos" },
  { $group: { _id: "$produtos.categoria" } },
  { $sort: { _id: 1 } },
  { $project: { _id: 0, categoria: "$_id" } }
])

// Qual a distribuição de produtos por categoria (quantos produtos diferentes aparecem em cada categoria)?
db.listas.aggregate([
  { $unwind: "$produtos" },
  { $group: { _id: "$produtos.categoria", count: { $sum: 1 } } },
  { $sort: { _id: 1 } },
  { $project: { _id: 0, categoria: "$_id", quantidade: "$count" } }
])

// Quais as designações e datas, em ordem cronológica, das listas que contêm o produto Batata?
db.listas.find(
  { "produtos.designacao": "Batata" },
  { designacao: 1, data: 1, _id: 0 }
).sort({ data: 1 })
